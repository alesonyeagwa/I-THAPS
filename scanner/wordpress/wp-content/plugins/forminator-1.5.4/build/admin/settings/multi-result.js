!function(e){formintorjs.define(["admin/settings/toggle-container","text!tpl/fields.html","admin/models/base-model"],function(t,i,s){return t.extend({multiple:!1,events:{"click .fui-add-result":"add_result","click .fui-result-delete":"delete_result","click .fui-open-media":"add_image","click .fui-browse-delete button":"clear_image","change .wpmudev-result-title":"update_title","change .wpmudev-result-image":"update_image"},className:"sui-form-field",init:function(){this.results=this.model.get("results"),this.listenTo(Forminator.Events,"forminator:quiz:results:order:updated",this.render)},render:function(){this.$el.html(""),this.$el.append(this.get_label_html()),this.$el.append(this.get_field_html());this.get_saved_value();this.$el.removeClass("fui-has-results"),this.results.length&&this.$el.addClass("fui-has-results"),this.trigger("rendered",this.get_value()),this.on_render()},get_field_html:function(){var t=this.get_values_html();return Forminator.Utils.template(e(i).find("#settings-field-result-list-tpl").html())({childs:t})},get_values_html:function(){var e=this;return this.results.map(function(t,i){return e.get_value_html(t,i)}).join(" ")},get_value_html:function(t,l){var r=this,n=Forminator.Utils.template(e(i).find("#settings-field-result-list-row-tpl").html()),u=t.toJSON(),a=new s({"result-description":u.description});return n({row:u,editor:new Forminator.Settings.Editor({model:a,id:"result-description-"+l,hide_label:!0,placeholder:"",name:"result-description",enableFormData:!1,hideEditorOptions:!0,on_change:function(e){r.results.get_by_index(l).set("description",e)}}).$el.html(),index:l})},add_result:function(e){e.preventDefault(),new_result=new Forminator.Models.Result({}),new_result.set("order",this.results.length),new_result.set("slug",Forminator.Utils.get_unique_id("result")),this.results.add(new_result,{silent:!0}),this.update(),this.render()},delete_result:function(t){t.preventDefault();var i=e(t.target),s=this.get_model(i);this.results.remove(s,{silent:!0}),this.update(),this.render()},get_index:function(e){return e.closest(".fui-result").data("index")},get_model:function(e){var t=this.get_index(e);return this.results.get_by_index(t)},update_title:function(t){var i=this.get_model(e(t.target)),s=e(t.target).val();i.set("title",s),this.update()},update_image:function(t){var i=this.get_model(e(t.target)),s=e(t.target).val();i.set("image",s),this.render()},add_image:function(t){t.preventDefault();var i=this,s=wp.media({title:this.options.popup_label,button:{text:this.options.popup_button_label},multiple:!1}).on("select",function(){var l,r=i.get_model(e(t.target)),n=s.state().get("selection").first().toJSON(),u=e(t.target).closest(".fui-result"),a=u.find(".fui-browse-preview span"),d=u.find(".fui-browse");$input=d.find("input"),n&&n.url&&(d.addClass("fui-browse-has-image"),l=n.url,_.isObject(n.sizes)&&(_.isObject(n.sizes.thumbnail)&&!_.isUndefined(n.sizes.thumbnail.url)?l=n.sizes.thumbnail.url:_.isObject(n.sizes.medium)&&!_.isUndefined(n.sizes.medium.url)?l=n.sizes.medium.url:_.isObject(n.sizes.large)&&!_.isUndefined(n.sizes.large.url)?l=n.sizes.large.url:_.isObject(n.sizes.full)&&!_.isUndefined(n.sizes.full.url)&&(l=n.sizes.full.url)),a.css("background-image","url('{url}')".replace("{url}",l)),$input.val("{url}".replace("{url}",l)),r.set("image",l))});s.open()},clear_image:function(t){var i=this.get_model(e(t.target)),s=e(t.target).closest(".fui-result"),l=s.find(".fui-browse-preview span"),r=s.find(".fui-browse"),n=r.find("input");r.removeClass("fui-browse-has-image"),l.css("background-image",""),n.val(""),i.set("image",""),this.render()},update:function(){Forminator.Events.trigger("forminator:quiz:results:updated")}})})}(jQuery);