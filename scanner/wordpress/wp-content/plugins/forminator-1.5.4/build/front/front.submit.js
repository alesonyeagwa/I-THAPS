!function(t,e,r,a){"use strict";function o(e,r){this.element=e,this.$el=t(this.element),this.forminatorFront=null,this.settings=t.extend({},i,r),this._defaults=i,this._name=n,this.init()}var n="forminatorFrontSubmit",i={form_type:"custom-form",forminatorFront:!1,forminator_selector:"",chart_design:"bar",chart_options:{}};t.extend(o.prototype,{init:function(){switch(this.forminatorFront=this.$el.data("forminatorFront"),this.settings.form_type){case"custom-form":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-custom-form"),this.handle_submit_custom_form();break;case"quiz":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-quiz"),this.handle_submit_quiz();break;case"poll":this.settings.forminator_selector&&t(this.settings.forminator_selector).length||(this.settings.forminator_selector=".forminator-poll"),this.handle_submit_poll()}},handle_submit_custom_form:function(){var r=this;t(this.element);r.$el.find(".forminator-cform-response-message").find(".forminator-label--success").not(":hidden").length&&r.focus_to_element(r.$el.find(".forminator-cform-response-message"),!0),t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(a){var o=t(this),n=new FormData(this),i=o.find(".forminator-cform-response-message"),s=o.find(".forminator-g-recaptcha");if(s.length){s=t(s.get(0));var l=s.data("forminator-recapchta-widget"),f=s.data("size"),d=e.grecaptcha.getResponse(l);if("invisible"===f&&0===d.length)return e.grecaptcha.execute(l),!1;if(r.$el.hasClass("forminator_ajax")&&e.grecaptcha.reset(l),i.html(""),s.hasClass("error")&&s.removeClass("error"),0===d.length)return s.hasClass("error")||s.addClass("error"),i.html('<label class="forminator-label--error"><span>'+e.ForminatorFront.cform.captcha_error+"</span></label>"),r.focus_to_element(i),!1}return!r.$el.hasClass("forminator_ajax")||(i.html(""),i.html('<label class="forminator-label--info"><span>'+e.ForminatorFront.cform.processing+"</span></label>"),r.focus_to_element(i),r.$el.find("input[type=file]").each(function(){""===t(this).val()&&"function"==typeof e.FormData.prototype.delete&&n.delete(t(this).attr("name"))}),a.preventDefault(),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:n,cache:!1,contentType:!1,processData:!1,beforeSend:function(){o.find("button").attr("disabled",!0)},success:function(a){o.find(".forminator-label--validation").remove(),o.find(".forminator-field").removeClass("forminator-has_error"),o.find("button").removeAttr("disabled"),i.html("");var s=a.success?"success":"error";void 0!==a.message?(i.html('<div class="forminator-label--'+s+'"><span>'+a.message+"</span></div>"),r.focus_to_element(i,"success"===s)):void 0!==a.data&&(s=a.data.success?"success":"error",i.html('<div class="forminator-label--'+s+'"><span>'+a.data.message+"</span></div>"),r.focus_to_element(i,"success"===s)),!a.data.success&&a.data.errors.length&&(o.trigger("forminator:form:submit:failed",n),r.show_messages(a.data.errors)),!0===a.success&&(o[0]&&(o[0].reset(),o.find(".forminator-upload--remove").hide(),o.find(".forminator-upload .forminator-input").val(""),o.find(".forminator-upload .forminator-label").html(e.ForminatorFront.cform.no_file_chosen),o.find(".forminator-select").each(function(){t(this).val(null).trigger("change")}),o.trigger("forminator:form:submit:success",n),o.trigger("forminator.front.condition.restart")),void 0!==a.data.url&&(e.location.href=a.data.url))},error:function(t){o.find("button").removeAttr("disabled"),i.html("");var a=400===t.status?e.ForminatorFront.cform.upload_error:e.ForminatorFront.cform.error;i.html('<label class="forminator-label--notice"><span>'+a+"</span></label>"),r.focus_to_element(i),o.trigger("forminator:form:submit:failed",n)}}),!1)})},handle_submit_quiz:function(){var r=this;t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(a){var o=t(this),n=[];return a.preventDefault(),r.$el.find(".forminator-has-been-disabled").removeAttr("disabled"),n=o.serialize(),r.$el.find(".forminator-has-been-disabled").attr("disabled","disabled"),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:n,beforeSend:function(){r.$el.find("button").attr("disabled","disabled")},success:function(t){t.success?"nowrong"===t.data.type?(e.history.pushState("forminator","Forminator",t.data.result_url),r.$el.find(".forminator-quiz--result").html(t.data.result),r.$el.find(".forminator-answer input").attr("disabled","disabled")):"knowledge"===t.data.type&&(e.history.pushState("forminator","Forminator",t.data.result_url),r.$el.find(".forminator-quiz--result").size()>0&&r.$el.find(".forminator-quiz--result").html(t.data.finalText),Object.keys(t.data.result).forEach(function(e){var a=r.$el.find("#"+e);a.find(".forminator-question--result").html("<span>"+t.data.result[e].message+"</span>"),a.find(".forminator-submit-rightaway").attr("disabled","disabled");var o,n=r.$el.find('[id|="'+t.data.result[e].answer+'"]'),i=n.closest(".forminator-answer");o=t.data.result[e].isCorrect?"forminator-is_correct":"forminator-is_incorrect",i.addClass(o)})):r.$el.find("button").removeAttr("disabled")}}),!1}),t("body").on("click",".forminator-result--retake",function(){location.reload()})},handle_submit_poll:function(){var r=this;r.$el.find(".forminator-poll-response-message").find(".forminator-label--success").not(":hidden").length&&r.focus_to_element(r.$el.find(".forminator-poll-response-message"),!0),t("body").on("submit.frontSubmit",this.settings.forminator_selector,function(a){var o=(t(this),r.$el.find(".forminator-poll-response-message"));return!r.$el.hasClass("forminator_ajax")||(o.html(""),o.html('<label class="forminator-label--info"><span>'+e.ForminatorFront.poll.processing+"</span></label>"),r.focus_to_element(o),a.preventDefault(),t.ajax({type:"POST",url:e.ForminatorFront.ajaxUrl,data:r.$el.serialize(),beforeSend:function(){r.$el.find("button").attr("disabled",!0)},success:function(t){r.$el.find("button").removeAttr("disabled"),o.html("");var a=t.success?"success":"error";!1===t.success?(o.html('<label class="forminator-label--'+a+'"><span>'+t.data.message+"</span></label>"),r.focus_to_element(o)):void 0!==t.data&&(a=t.data.success?"success":"error",o.html('<label class="forminator-label--'+a+'"><span>'+t.data.message+"</span></label>"),r.focus_to_element(o,"success"===a)),!0===t.success&&(void 0!==t.data.url?e.location.href=t.data.url:void 0!==t.data.chart_data&&t.data.chart_data.length>1&&"undefined"!=typeof google&&(void 0===google.visualization?(google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(function(){r.render_poll_chart(t.data.chart_data,t.data.back_button,r)})):r.render_poll_chart(t.data.chart_data,t.data.back_button,r)))},error:function(){r.$el.find("button").removeAttr("disabled"),o.html(""),o.html('<label class="forminator-label--notice"><span>'+e.ForminatorFront.poll.error+"</span></label>"),r.focus_to_element(o)}}),!1)})},render_poll_chart:function(e,a,o){o.$el.find(".forminator-poll--chart").remove();var n=o.$el.attr("id")+"-"+o.$el.data("forminatorRender"),i="forminator-chart-poll-"+n,s=t('<div id="'+i+'" class="forminator-poll--chart" style="width: 100%; height: 300px;"></div>'),l=google.visualization.arrayToDataTable(e),f=t(a),d=!1;t(s).insertBefore(o.$el.find(".forminator-poll--answers")),o.$el.find(".forminator-poll--answers").hide(),o.$el.find(".forminator-poll--actions").empty(),f.click(function(t){t.preventDefault(),location.reload()}),o.$el.find(".forminator-poll--actions").append(f),"bar"===o.settings.chart_design?d=new google.visualization.BarChart(r.getElementById(i)):"pie"===this.settings.chart_design&&(d=new google.visualization.PieChart(r.getElementById(i))),d&&d.draw(l,o.settings.chart_options)},focus_to_element:function(r,a){a=a||!1,r.show(),t("html,body").animate({scrollTop:r.offset().top-(t(e).height()-r.outerHeight(!0))/2},500,function(){r.attr("tabindex")||r.attr("tabindex",-1),r.focus(),a&&r.show().delay(5e3).fadeOut("slow")})},show_messages:function(e){var r=this,a=r.$el.data("forminatorFrontCondition");if(void 0!==a){this.$el.find(".forminator-label--validation").remove();var o=0;e.forEach(function(e){var n=Object.keys(e),i=Object.values(e),s=a.get_form_field(n);if(s.length){if(0===o&&(r.$el.trigger("forminator.front.pagination.focus.input",[s]),r.focus_to_element(s)),t(s).hasClass("forminator-input-time")){var l=t(s).closest(".forminator-field:not(.forminator-field--inner)"),f=l.children(".forminator-label--validation");0===f.length&&(l.append('<label class="forminator-label--validation"></label>'),f=l.children(".forminator-label--validation")),f.text(i)}var d=t(s).closest(".forminator-field--inner");0===d.length&&(d=t(s).closest(".forminator-field"),0===d.length&&(d=t(s).find(".forminator-field"),d.length>1&&(d=d.first())));var m=d.find(".forminator-label--validation");0===m.length&&(d.append('<label class="forminator-label--validation"></label>'),m=d.find(".forminator-label--validation")),t(s).attr("aria-invalid","true"),m.text(i),d.addClass("forminator-has_error"),o++}})}return this}}),t.fn[n]=function(e){return this.each(function(){t.data(this,n)||t.data(this,n,new o(this,e))})}}(jQuery,window,document);